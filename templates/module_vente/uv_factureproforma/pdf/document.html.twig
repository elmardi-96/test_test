<!DOCTYPE html>
<html>
	<head><meta charset="fr">
		<title>Facture client</title>
	</head>
	<style>


		@page {
			margin: 180px 20px 210px 20px !important;
			padding: 0 !important;
		}

		@page :first .footer {
    	display: none;
		}
		body {
			font-family: 'Courier';
			font-size: 13px;
		}

		.header {
			position: fixed;
			top: -180px;
			left: 0;
			right: 0;
		}


		.logo {
			max-width: 250px;
			max-height: 100px;
			text-align: right;
		}

		.footer {
			/*border-top: 2px solid #555555;*/
			margin-top: 10px;
			font-size: 9px;
			text-align: center;
			position: fixed;
			bottom: 3px;
			left: 0;
			right: 0;
		}


		* {
			font-family: Courier, sans-serif;
			text-transform : uppercase;
		}

		main {
			margin-top: 0;
		}
		.page-break {
        page-break-after: always;
    }
	</style>

	<body>
            {# ------------- HEADER ---------------------- #}

            <div class="header">
            <table
                style="width: 100%; margin: 20px 0px"
                align="center"
                cellspacing="0"
            >
                <tr>
                <td style="width: 35%; text-align: left">
                    <div style="line-height: 15px">
                    <span
                        style="
                        font-size: 11px;
                        text-transform: uppercase;
                        font-weight: bold;
                        "
                    >
                        {{ cab.dossier.titre}} </span
                    ><br />
                    <span style="font-size: 9px">{{ cab.dossier.adresse}}</span><br />
                    <span style="font-size: 9px">Tel :{{ cab.dossier.tel}}</span
                    ><br />
                    <span style="font-size: 9px">Fax :{{ cab.dossier.tel}}</span
                    ><br />
                    </div>
                </td>
                <td style="width: 65%; text-align: right">
					<img src="{{ asset(image)[1:] }}" width = "{{ cab.dossier.WidthLogo }}" height="{{ cab.dossier.HeightLogo }}" class="logo" alt="Logo" />                </td>
                </tr>
            </table>

            <table
                style="
                width: 100%;
                text-align: center;
                border: 0.3px solid #292929;
                "
            >
                <tr>
                <td style="width: 30%">
                    <table style="width: 100%; text-align: center">
                    <tr>
                        <th style="width: 100%; font-size: 11px; font-weight: 200">
                        DATE FACTURE
                        </th>
                    </tr>
                    <tr>
                        <td
                        style="border-bottom: solid 0.3px #292929; width: 100%"
                        ></td>
                    </tr>
                    <tr>
                        <td style="width: 100%; font-size: 11px; font-weight: bold">
						{{cab.datefacture | date("d/m/Y")}}
                        </td>
                    </tr>
                    </table>
                </td>
                <td
                    style="
                    width: 40%;
                    font-size: 16px;
                    font-weight: bold;
                    border: 0.3px solid #292929;
                    border-bottom: none;
                    border-top: none;
                    "
                >Facture Proforma
                </td>
                <td style="width: 30%; text-align: center">
                    <table style="width: 100%; background: #ffffff; text-align: center">
                    <tr>
                        <th style="width: 100%; font-size: 11px; font-weight: 200">
                        N° FACTURE
                        </th>
                    </tr>
                    <tr>
                        <td
                        style="border-bottom: solid 0.3px #292929; width: 100%"
                        ></td>
                    </tr>
                    <tr>
                        <td style="width: 100%; font-size: 11px; font-weight: bold">
                              {{ cab.Codeproforma|upper }}
                        </td>
                    </tr>
                    </table>
                </td>
                </tr>
            </table>
            <div>
                {# -------------------------END HEADER --------------------------- #} {#
                -------------------------FOOTER --------------------------- #}

                <div class="footer">
				
                <br />
                <div
                    style="
                    position: relative;
                    left: 5%;
                    width: 90%;
                    border-top: 0.3px solid #000;
                    padding: 5px;
                    text-align: center;
                    font-size: 11px;
					margin-top: 60%;
                    "
                >
                    Av. Allal El Fassi Madinat Al Irfane Hay Riad 10000 Rabat<br>
					
ICE : 002689450000020 RC : 148587 IF : 47343972

                </div>
                </div>
            </div>
            </div>
            {# -------------------------FOOTER --------------------------- #}


		<main>
	
			

			<br>
			<!--II-  Informations Fournisseur-->
			<table cellspacing="0" style="width: 100%; text-align: left; font-size: 12px">
				
				<tr>
					<td style="padding: 10px 4px  ; text-transform: uppercase;font-weight: bold;font-size: 13px">INFORMATIONS CLIENT</td>
				</tr>
			</table>
			<table style="width: 100%; text-align: left; font-size: 9px;">
				<tr style="width: 50%">
					<td style="width: 100% ;">
						<table style="width: 100% ;">
							<tr>
								<td style="width: 35% ;border: 0.3px solid #292929;font-weight: bold ">
									<table style="width: 100% ; ">
										<tr>
											<td style="width: 100%">Client :</td>
										</tr>
									</table>
								</td>
								<td style="width: 65%;border: 0.3px solid #292929; font-weight: bold">
									<table style="width: 100% ;">
										<tr>
											<td style="width: 100%">FONDATION CHEIKH ZAID </td>
										</tr>
									</table>
								</td>
							</tr>
							<tr>
								<td style="width: 35% ;border: 0.3px solid #292929 ">
									<table style="width: 100% ; ">
										<tr>
											<td style="width: 100%">Adresse : </td>
										</tr>
									</table>
								</td>
								<td style="width: 65%;border: 0.3px solid #292929">
									<table style="width: 100% ;">
										<tr>
											<td style="width: 100%">Av. Allal El Fassi Madinat Al Irfane Hay Riad 10000 Rabat </td>
										</tr>
									</table>
								</td>
							</tr>
							<tr>
								<td style="width: 35% ;border: 0.3px solid #292929;">
									<table style="width: 100% ; ">
										<tr>
											<td style="width: 100%">ICE : </td>
										</tr>
									</table>
								</td>
								<td style="width: 65%;border: 0.3px solid #292929">
									<table style="width: 100% ;">
										<tr>
											<td style="width: 100%">
													
												001713416000075

											</td>
										</tr>
									</table>
								</td>
							</tr>
				
						</table>
					</td>


                    <td style="width: 100% ;">
						<table style="width: 100% ;margin-top:-10px">
						<tr>
								<td style="width: 35% ;border: 0.3px solid #292929">
									<table style="width: 100% ; ">
										<tr>
											<td style="width: 100%">Ville/Pays :</td>
										</tr>
									</table>
								</td>
								<td style="width: 65%;border: 0.3px solid #292929">
									<table style="width: 100% ;">
										<tr>
											<td style="width: 100%">
													
												Rabat / Maroc

											</td>
										</tr>
									</table>
								</td>
							</tr>
							<tr>
								<td style="width: 35% ;border: 0.3px solid #292929">
									<table style="width: 100% ; ">
										<tr>
											<td style="width: 100%">Télé :</td>
										</tr>
									</table>
								</td>
								<td style="width: 65%;border: 0.3px solid #292929">
									<table style="width: 100% ;">
										<tr>
											<td style="width: 100%">Télé : +212(05) 37 68 68 68</td>
										</tr>
									</table>
								</td>
							</tr>
								<tr>
								<td style="width: 35% ;border: 0.3px solid #292929;">
									<table style="width: 100% ; ">
										<tr>
											<td style="width: 100%">Mail :</td>
										</tr>
									</table>
								</td>

								<td style="width: 65%;border: 0.3px solid #292929">
									<table style="width: 100% ;">
										<tr>
											<td style="width: 50%">contact@hcz.ma</td>
										</tr>
									</table>
								</td>
							</tr>
							{# <tr style="visibility: hidden;">
								<td style="width: 35% ;">
									<table style="width: 100% ; ">
										<tr>
											<td style="width: 100%">hidden</td>
										</tr>
									</table>
								</td>

								<td style="width: 65%;">
									<table style="width: 100% ;">
										<tr>
											<td style="width: 50%">hidden</td>
										</tr>
									</table>
								</td>
							</tr> #}
						</table>
					</td>


				</tr>
				
			</table>

			<!--End II-  Informations Fournisseur-->
			<table cellspacing="0" style="width: 100%; text-align: left; font-size: 12px">
				<tr>
					<td>
						<p style="padding: 0px 4px  ; text-transform: uppercase;font-weight: bold;font-size: 13px">Objet :   {{ cab.Objet|upper }}
						</p>
						<p style="padding: 0px 4px  ; text-transform: uppercase;font-weight: bold;font-size: 13px">Lieu :  {{ cab.Lieu|upper }}
						</p>
					</td>
				</tr>
					
			</table>


			


			<table class="" style="width: 100% ;" cellspacing="0">
				<thead>
					<tr style="background-color: #BEBEBE; color:black; font-size: 9px;">
						<th style="width: 5%;padding: 3px">ORD</th>
						<th style="width: 10%;padding: 3px">REFERENCE</th>
						<th style="width: 40%;padding: 3px">DESIGNATION</th>
						<th style="width: 5%;padding: 3px">UNITE</th>
						<th style="width: 5%;padding: 3px;text-align: center;">QNT</th>
						<th style="width: 10%;padding: 3px;text-align: center;">PRIX H.T</th>
						<th style="width: 10%;padding: 3px;text-align: center;">Total TTC</th>
						
					</tr>
				</thead>
				<tbody>
	
						{% for key, detail in details   %}
						{% set  key = key + 1  %}
					<table>
							<tr>
								<td style="width: 5%;text-transform:uppercase;padding: 3px;font-size: 9px;text-align: left;">{{key}}</td>
								<td style="width: 10%;text-transform:uppercase;padding: 3px;font-size: 9px;text-align: left;"></td>
								<td style="width: 40%;text-transform:uppercase;padding: 3px;font-size: 9px;text-align: left;">
								{{ detail.article }}
								</td>
								<td style="width: 5%;text-transform:uppercase;padding: 3px;font-size: 9px;text-align:center;"></td>
								<td style="width: 5%;text-transform:uppercase;padding: 3px 10px;font-size: 9px;text-align: right;">{{ detail.quantite }}</td>
								<td style="width: 5%;text-transform:uppercase;padding: 3px 25px 3px 0;font-size: 9px;text-align: right;">{{ detail.prixunitaire|number_format(2, ',', ' ')  }}</td>
								<td style="width: 5%;text-transform:uppercase;padding: 3px;font-size: 9px;text-align: right;">{{ ((detail.prixunitaire * detail.quantite) * ( 1 + (detail.tva)/100 ))|number_format(2, ',', ' ')  }}</td>

							</tr>
						{% endfor %}

						{% for  detail in detailsnew   %}
						{% set key = details|length  %}

							<tr>
								<td style="width: 5%;text-transform:uppercase;padding: 3px;font-size: 9px;text-align: left;"></td>
								<td style="width: 10%;text-transform:uppercase;padding: 3px;font-size: 9px;text-align: left;">{{ detail.article.code }}</td>
								<td style="width: 40%;text-transform:uppercase;padding: 3px;font-size: 9px;text-align: left;">{{ detail.article.titre }}</td>
								<td style="width: 5%;text-transform:uppercase;padding: 3px;font-size: 9px;text-align:center;"></td>
								<td style="width: 5%;text-transform:uppercase;padding: 3px 10px;font-size: 9px;text-align: right;">{{ detail.quantite }}</td>
								<td style="width: 5%;text-transform:uppercase;padding: 3px 25px 3px 0;font-size: 9px;text-align: right;">{{ detail.prixunitaire|number_format(2, ',', ' ')  }}</td>
								<td style="width: 5%;text-transform:uppercase;padding: 3px;font-size: 9px;text-align: right;">{{ ((detail.prixunitaire * detail.quantite) * ( 1 + (detail.tva)/100 ))|number_format(2, ',', ' ')  }}</td>

							</tr>
							<tr>
							<td colspan="7">

								{# <table style="width: 100% ;">
									{% set detail1 = render(controller('App\\Controller\\moduleVente\\UvFacturecabController::getDevisTechnique', { factureId: detail.cab.id, articleId:detail.article.id })) %}
									<tbody>
										{% if detail1 %}

											{{detail1|raw}}

										{% endif %}
									</tbody>

								</table> #}
								<table style="width: 100% ;">
									{% set detail1 = render(controller('App\\Controller\\moduleVente\\UvFacturecabController::getDevisTechnique', { factureId: detail.cab.id, articleId:detail.article.id })) %}
									{% set detTechnique = detail1|split('</tr>') %}
									<tbody>
										{% if detail1 %}
											{% for i in 0..(detTechnique|length-1) %}
												{% if i == 46 %}
													</tbody>
												</table>
												<div style="page-break-after: always;"></div>
												<table style="width: 100% ;">
													<tbody>
												{% endif %}
												{{ detTechnique[i]|raw }}
											{% endfor %}
										{% endif %}
									</tbody>
								</table>

							</td>
							</tr>
							
						{% endfor %}

					</table>
					
				</tbody>

			</table>

			<br>
			<br>
			<br>
			<table cellspacing="0" style="width: 100%;">
				<tr>
                    <td style="width: 100% "></td>
					<td style="width: 100% ">
						<table style="width: 100% ; background: #FFFFFF;font-size: 10px;margin:0px;" cellspacing="0">
							<tr>
								<td style="background-color:rgb(170, 170, 170);padding: 5px;">TOTAL HT :</td>
								<td style="width: 0.1%; "></td>
								<td style="width:20%;text-align:right">{{(prixTotHT + prixTotHTnew)|number_format(2, ',', ' ') |default('0')}}</td>
							</tr>
							<tr>
								<td style="background-color:rgb(170, 170, 170);padding: 5px;">REMISE :
								</td>
								<td></td>
								<td style="width:20%;text-align:right">0</td>
							</tr>
							<tr>
								<td style="background-color:rgb(170, 170, 170);padding: 5px;">NET HT :
								</td>
								<td style="width: 0.1%; "></td>
								<td style="width:20%;text-align:right">{{(prixTotHTnew + prixTotHT)|number_format(2, ',', ' ') |default('0') }}</td>
							</tr>
							<tr>
								<td style="background-color:rgb(170, 170, 170);padding: 5px;">TVA :
								</td>
								<td style="width: 0.1%; "></td>
								<td style="width:20%;text-align:right">{{(TotTvanew + TotTva)|number_format(2, ',', ' ')  |default('0')}}</td>
							</tr>
							<tr>
								<td style="background-color:rgb(170, 170, 170);padding: 5px;">TOTAL TTC :
								</td>
								<td></td>
								<td style="width:20%;text-align:right">{{(prixTotNetnew + prixTotNet)|number_format(2, ',', ' ')  |default('0')}}</td>
							</tr>
							<tr>
								<td style="background-color:rgb(170, 170, 170);color:rgb(69, 69, 69);font-weight : bold; width: 30%;padding: 5px;">NET A PAYER () :
								</td>
								<td></td>
								<td style="width:20%;font-weight : bold;text-align:right">{{(prixTotNetnew + prixTotNet)|number_format(2, ',', ' ')  |default('0')}}</td>
							</tr>
						</table>
					</td>
                    <td style="width: 0%"></td>
				</tr>
			</table>

			<p style="font-size: 10px;">Arrêtée la présente facture proforma à la somme de : 
			<b>{{text}}</b>
				<b></b>
				</p>

	


		</main>
	</body>

</html>
